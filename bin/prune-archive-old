#!/bin/bash
# Remove old files from the archive and merge directories together

. /home/seaman/bin/bash-vars

# Make sure you are running from Archive
d=`pwd`
if [ `basename $d` != "Archive" ] ; then
    echo "You must be in Archive to run this command"
    exit 1
fi

if [ ! -d "$d" ] 
then
    echo "Directory does not exist, $d"
    exit 1
fi


# If this directory exists then prune it
function merge_dir {
    if [ ! -d "$1" ] ; then return; fi
    if [ ! -d "$2" ] ; then mkdir -p "$2"; fi
    rsync -auv "$1/" "$2" && rm -rf "$1"
}

#---------------------------------------------------------------------
function prune_2010
{
    echo "Prune 2010"
    cd $d/2010

    merge_dir Mark .
    merge_dir Books Documents/Books
    merge_dir Installers/Linux          Installers-Linux
    merge_dir Installers-Linux/2010     Installers-Linux
    merge_dir Installers-Windows/2009   $d/2009/Installers-Windows
    merge_dir Installers-Linux/2009     $d/2009/Installers-Linux
    merge_dir Installers-Linux/2008     $d/2008/Installers-Linux
    merge_dir Installers/Windows/2010   Installers-Windows
    merge_dir Installers/Windows        Installers-Windows
    merge_dir Sheeva                    Tools/Sheeva

    remove-dir .local
    remove-dir .mozilla
    remove-dir .mozilla-thunderbird
    remove-dir .thunderbird
    remove-dir .thunderbird
    remove-dir 08-01
    remove-dir Archive/rcp
    remove-dir Archive/rcp-1
    remove-dir Archive/rcp-2
    remove-dir Archive/rcpx
    remove-dir config
    remove-dir Documents/Action2
    remove-dir Documents/mini-Action
    remove-dir Documents/Books/.git
    remove-dir old
    remove-dir wme/logs
    remove-dir wme/platform-git
    remove-dir Desktop
    remove-dir Music
    remove-dir Pictures
    remove-dir Installers

    merge_dir  Archive . 
}

#---------------------------------------------------------------------
function prune_2009
{
    cd $d/2009
    merge_dir Archive . 
    merge_dir Mark .
    merge_dir Mini .
    merge_dir bin/logs logs
    merge_dir ../../Installers/Linux/2009 Installers-Linux
    merge_dir ../../Installers/Windows/2009 Installers-Windows
    merge_dir 'Documents/Clients/TextRacing/Other/Business' Documents/Clients/TextRacing
    merge_dir 'Documents/Clients/TextRacing/Doc/Business'   Documents/Clients/TextRacing  
    merge_dir 'Tools/portable/PortableApps/ThunderbirdPortable/Data/profile/Mail' Mail  
    merge_dir 'Documents/Mail/Local Folders' Mark/Mail

    remove-dir trash
    remove-dir 'junk'    
    remove-dir  rcp

    cd Documents/
    merge_dir RealEstate Business/RealEstate
    merge_dir Books ../Books   
    merge_dir ../Books/SD_West ../Books/Programming/SD_West
    
    cd Clients/
    merge_dir TextRacing/Other  MikeEstes
    merge_dir TextRacing/Doc/MikeEstes  MikeEstes
    merge_dir TextRacing/MikeEstes  MikeEstes
    merge_dir TextRacing/Doc  MikeEstes
    merge_dir MikeEstes/Other  MikeEstes
    merge_dir MikeEstes/GoogleDocs  MikeEstes
    
    cd $d/2009/Code
    merge_dir net/ErrorHandling/ErrorHandling net/ErrorHandling
    merge_dir ErrorHandling/ErrorHandling ErrorHandling
    merge_dir ErrorHandling net/ErrorHandling
}

#---------------------------------------------------------------------
function prune_2008
{
    cd $d/2008
    merge_dir Archive . 
    merge_dir ../../Installers/Linux/2008 Installers-Linux
    merge_dir ../../Installers/Windows/2008 Installers-Windows

    remove-dir Mark/wm/git-repo
    
    remove-dir Installers-Linux/slackware-11.0-chroot
    remove-dir Installers-Linux/slackware-12.1-chroot
    remove-dir Installers-Windows/WMWare
        
    merge_dir 'SWS/tools/portable/PortableApps/ThunderbirdPortable/Data/profile/Mail' Mark/Mail
    merge_dir 'SWS/Tools/portable/PortableApps/ThunderbirdPortable/Data/profile/Mail' Mark/Mail
    
    merge_dir 'Mark/Download/Data files/From Thumb Drive' Mark
    merge_dir "Mark/Download/Data files/Documents on Mark's PDA" Mark
    
    merge_dir 'Mark/Download/Data files/From Thumb Drive/Work (Seaman4)' Mark
    merge_dir 'Mark/Download/Data files/From Thumb Drive/Seaman5' Mark
    merge_dir 'Mark/Download/Data files/Bin' Mark
    merge_dir 'Mark/Download/Data files/Learning' Mark
    merge_dir 'Mark/Download' Mark
    merge_dir Mark .
    merge_dir 'Installers-Windows/Portable Apps' 'Installers-Windows'

}

#---------------------------------------------------------------------
function prune_2007
{
    cd $d/2007
    remove-dir Mark/Mail/Old
}

#---------------------------------------------------------------------
log=/home/seaman/Documents/logs/prune-archive
(
    # Global
    remove-dirs Release 
    remove-dirs Debug   
   
    prune_2010 
    prune_2009 
    prune_2008 
    prune_2007 
    
) &> $log; cat $log
