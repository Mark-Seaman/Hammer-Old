#!/bin/bash
# Use PGP to unlock private files

# Preliminaries:
#   inst gpa seahorse

f=Secure

# Make sure file exists
echo   ~/Projects/$f.zip.gpg
ls -l  ~/Projects/$f.zip.gpg
if [ ! -f "/home/seaman/Projects/$f.zip.gpg" ] 
then
    echo "Could not find file, $f.zip.gpg" 
else

    echo "Unpacking the directory ($f.zip.gpg)"
    cd ~/Projects/
    gpg --decrypt $f.zip.gpg > $f.zip

    # Make sure file exists
    if [ ! -f "$f.zip" ] 
    then
        echo "Could not find file, $f.zip" 
    else

        # Remove the archive files
        unzip "$f.zip"
        if [ ! -d $f ] 
        then
            echo "No directory created $f" 
        else

            # Remove temp files
            mv $f.zip     /tmp/privzip$$
            mv $f.zip.gpg /tmp/privgpg$$

            # Show the files
            cd  ~/Projects/$f
            find | grep -v '.git'
            cd  ~/Projects/Secure/2014/Invoice
            ls -l
            e ~/Projects/Secure/2014/Invoice
        fi
    fi
fi
