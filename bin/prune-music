#!/bin/bash
# Prune the music by merging and deleting extra music files

# Setup the execution context
. /home/seaman/bin/bash-vars

cd /home/seaman/LiveSync/Music

music=`pwd`
base=`basename $music`
echo "Prune $music $base"

if [ "$base" != "Music" ]
then
    echo "prune-music must be run in music directory"
    exit 1
fi

if [ ! -w $music ]
then
    echo "Music directory is not writable"
    exit 1
fi

cd $music
{
    echo "Music pruning started   `date`"
    echo `find . -type f -name *.mp3 | wc -l` songs

    files=`ls *m3u 2>/dev/null`; if [ ! -z "$files" ]; then rm *.m3u; fi

    merge Rip Rock
    rm -rf Rock/?-?

    merge Foriegn\ Language Foreign

    merge Christian/Classic\ Rock Christian/Christian-Oldies
    merge Christian/Modern\ Rock Christian/Christian-Rock

    merge Other/New Rock

    merge Rock/Various\ Artists\ -\ Gammon\ Records Rock/Various\ Artists
    merge Rock/Various\ Artists\ -\ New\ West\ Records Rock/Various\ Artists

    merge Rock/Little\ Walter\ -\ Otis\ Rush Rock/Little\ Walter
    
    mkdir -p Rock/Bob\ Seger
    merge Rock/Bob\ Seger\ \&\ the\ Silver\ Bullet\ Band Rock/Bob\ Seger
    merge Rock/Bob\ Seger\ \&\ The\ Silver\ Bullet\ Band Rock/Bob\ Seger

    merge Rock/Joan\ Jett\ \&\ The\ Blackhearts/* Rock/Joan\ Jett\ and\ the\ Blackhearts
    remove-dir Rock/Joan\ Jett\ \&\ The\ Blackhearts

    merge Rock/Campbelljohn* Rock/John\ Campbell

    remove-dir "Vinyl/Neil Young"

    merge "Rock/Deep Purple/Rapture of the Deep_ Special Edition" "Rock/Deep Purple/Rapture of the Deep"
    merge "Rock/Deep Purple/Rapture of the Deep Special Edition" "Rock/Deep Purple/Rapture of the Deep"

    merge 'Another Brick In The Wall Part II - The Remixes' 'The Wall (1979)'
    merge 'The Wall Disc 2' 'The Wall (1979)'

    remove-dir "Rock/Unknown Artist"
    remove-dir "Rock/Gillan"
    remove-dir "Rock/santana"

    rm Rock/Folder.jpg Rock/desktop.ini Rock/Thumbs.db Rock/AlbumArt*

    echo `find . -type f -name *.mp3 | wc -l` songs   
    echo "Music pruning complete  `date`"
} | mklog prune-music



