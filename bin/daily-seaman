#!/bin/bash
# Daily task run by the seaman user 

# To run this command manually as root use
#   sudo nohup /home/seaman/bin/daily &> /dev/null&

bin=/home/seaman/bin
. /home/seaman/bin/bash-vars

{
    echo `date` " - Started daily-seaman "
    id

    # Executed as user 'seaman'
    function execute {
        echo '---------------------------------------'
        echo $1 $2; 
        date; 
        $bin/$1 $2        
    }

    # Hummer
    if [ "seaman-hummer" == `hostname` ]
    then    
        execute s
        execute rmas /home/seaman
        execute commit-logs
    fi

    # Chute
    if [ "seaman-chute" == `hostname` ]
    then
        execute s
        execute reminders
        execute music-select
        execute mb-publish
        execute clean
        execute commit-logs
        execute mb-daily
        execute life-send
    fi

    # Sub
    if [ "seaman-sub" == `hostname` ]
    then
        execute s
        execute rmas /home/seaman
        execute commit-logs
    fi

    # Server
    if [ "seaman-server" == `hostname` ]
    then
        execute s
        execute music-select
        execute rmas /home/seaman
        execute commit-logs
    fi

    # Server
    if [ "seaman-ultra" == `hostname` ]
    then
        execute s
        execute clean
        execute commit-logs
    fi

    # Mini
    if [ "seaman-mini" == `hostname` ]
    then
        execute s
        execute rmas /home/seaman
        execute music-copy
        execute commit-logs
    fi
        
    echo `date` " - All done"
} 2>&1 | mklog daily-report

echo /home/seaman/bin/daily-report |at -v 6:00
 