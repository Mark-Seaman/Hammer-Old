#!/bin/bash
# refresh the managed directory by copying random music

. /home/seaman/bin/bash-vars
{
    date

    REMOTE_MUSIC=~/FileShare/Music
    LOCAL_MUSIC=~/Music

    echo "Music Library: $REMOTE_MUSIC"
    echo "Music Selection: $LOCAL_MUSIC"

    if [ ! -d $REMOTE_MUSIC ]
    then
        echo "Can not open directory, $REMOTE_MUSIC"
        exit 1
    fi

    if [ ! -d $LOCAL_MUSIC/managed ]
    then
        mkdir $LOCAL_MUSIC/managed
    fi

    rm $LOCAL_MUSIC/managed/*

    cd $REMOTE_MUSIC
    find $REMOTE_MUSIC/Rock -iname "*.mp3"   | shuf -n 400 |
    sed 's/\(.*\)\/\(.*\)/cp \"\1\/\2\" \"\/home\/seaman\/Music\/managed\/\2"/' |tee $LOCAL_MUSIC/cpmusic.sh

    cat $LOCAL_MUSIC/cpmusic.sh | sh
    ls $LOCAL_MUSIC/managed | echo `wc -l` songs managed
} | mklog music-select
